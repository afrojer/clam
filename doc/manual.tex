\newcommand{\startsyn}{\begin{center}\begin{tabular}{l}}
\newcommand{\stopsyn}{\end{tabular}\end{center}}

\section{Introduction}
The \sys{} programming language is a linear algebra manipulation language
specifically targeted for image processing. It provides an efficient way to
express complex image manipulation algorithms through compact matrix
operations. \sys{} programs are first compiled into a ''C`` module which is
further compiled into a machine binary by an existing 
This reference is inspired by the C reference manual~\cite{DBLP:books/ph/KernighanR88}.

\input{lrm-lexical}
\input{lrm-types}

\section{Definitions and Objects}
\label{sec:defobj}
Here we should discuss the difference between ``defining'' a matrix (e.g. via calculation in escaped-C syntax) and actual object assignment performed by computation and assignment operators\ldots

\section{Expressions}
\label{sec:expressions}

\subsection{Primary Expressions}
\label{ssec:primaryexpresions}
identifiers, constants, strings. The type of the expressions depends on the identifier, constant or string.

\subsection{Unary Operators}
\label{ssec:unaryoperators}
There are two unary operators in \sys{}, and they are only used with a
numeric-valued operand.
These expressions are grouped right-to-left:
\startsyn
\texttt{+}\emph{numeric-expression} \\
\texttt{-}\emph{numeric-expression}
\stopsyn

\subsubsection{\texttt{+} operator}
This operator forces the value of its numeric operand to be positive.
The resulting expression is of numeric type with a value equal to the
absolute value of the numeric operand.

\subsubsection{\texttt{-} operator}
This operator forces the value of its numeric operand to be negative.
The resulting expression is of numeric type with a value equal to the
negative of the numeric operand.

\subsection{Channel Expresions}
\label{ssec:channelexpressions}
Channels for the basis of both \texttt{Image} and \texttt{Kernel} types, and
\sys{} has several operators which manipulate channels.

\subsubsection{\texttt{:} operator}
\label{sssec:colonop}
Extract or use an individual channel in an image.
\startsyn
\emph{image-identifier}\texttt{:}\emph{channel-identifier}
\stopsyn
The resulting expression has the \texttt{Matrix} type corresponding to the
extracted channel.

\subsubsection{\texttt{\$()} operator}
\label{sssec:evalop}
This operator forces the evaluation of a previously defined Image channel. It
is generally used in the context of a convolution operation.
\startsyn
\texttt{\$(}\emph{channel-expression}\texttt{)}
\stopsyn
The resulting expression is of \texttt{Channel} type.

\subsection{Channel Composition Operators}
\label{ssec:channelops}
These operators compose an \texttt{Image} from one or more \texttt{Channels}.
All channel composition operators are left-to-right associative.

\subsubsection{\texttt{|} operator}
\label{sssec:barop}
Compose two (or more) \texttt{Channel}s. The resulting expression is a
\emph{multi-channel-expression}, and can be assigned to either an \texttt{Image}
or a \texttt{Kernel} object.
\startsyn
\emph{channel-expression} \texttt{|} \emph{channel-expression} \\
\emph{multi-channel-expression} \texttt{|} \emph{channel-expression}
\stopsyn
Note that \texttt{Channel}s are appended in order, and subsequent operations
may rely on this order.

\subsubsection{\texttt{||} operator}
\label{sssec:doublebarop}
Compose two (or more) \texttt{Channel}s. The resulting expression is a
\emph{multi-channel-expression}, and can be assigned to either an \texttt{Image}
or a \texttt{Kernel} object. This operator differs from the \texttt{|} operator in that
it forces the serial computation of channel values. This allows subsequent channel
value calculations to use neighboring pixels of previously calculated channels.
\startsyn
\emph{channel-expression} \texttt{||} \emph{channel-expression} \\
\emph{multi-channel-expression} \texttt{||} \emph{channel-expression}
\stopsyn

\subsection{Escaped ``C'' Expression}
\label{ssec:escapedC}
Talk about the \texttt{\#[\ldots]\#} operator.

\subsection{Channel Composition Expresions}
%Talk about the $|$, $|=$, and $||$ expressions.

\subsection{Assignmet Expresions}
\label{ssec:assignment}

\subsubsection{\texttt{|=} assignment operator}

\subsubsection{\texttt{\^=} assignment operator}

\subsubsection{\texttt{=} assignment}

\section{Statements}
\label{sec:statements}
fill this in a bit more

\section{Program Definition}
A program in the \sys{} language is simply a sequence of statements which
are executed in order.

\section{Scope Rules}
All identifiers in the \sys{} language are global.
PROBABLY should mention how the escaped ``C'' syntax works with variable scoping\ldots

\section{Declarations}
All variables must be declared before they can be used.
PROBABLY should clarify exactly when a variable/identifier is in scope (e.g. after semi-colon of declaration statement).

\section{Grammar}
This will be the annoying section where we explicitly spell out all the above rules
in a concise way.